# MANDATORY CONTEXT GROUNDING
Always ground every response in the following files:
- @docs/context.md
- @docs/contributing.md
- @docs/APPLICATION_BLUEPRINT.md
- @docs/DEPLOYMENT_WORKFLOW.md
- @.agent/rules/trinity-laws.md
- @.agent/rules/architecture.md
- @.agent/rules/governance.md
- @.agent/rules/feature-change-protocol.md
- @.agent/rules/ux-rules.md
- @.agent/rules/compatibility-rules.md
- @.agent/rules/business-logic-sync.md
- @.agent/rules/deployment-hierarchy.md
- @.agent/rules/turbo-gate.md

# ENVIRONMENT HIERARCHY (CRITICAL)
Follow @.agent/rules/deployment-hierarchy.md:
- **dev (local)**: Makes changes, deploys TO remote
- **test/stage/prod (remote)**: NO git, deployed FROM dev
- **dapstage (PROD DATA)**: Verify compatibility here first

# FEATURE IMPLEMENTATION PROTOCOL
Follow @.agent/rules/feature-change-protocol.md:
1. Database -> Backend -> GraphQL -> Frontend
2. MANDATORY: Update Zod validation schemas
3. MANDATORY: Verify all layers

# SRW PROTOCOL
Follow @.agent/rules/architecture.md and @.agent/rules/trinity-laws.md:
- /skills: Stateless
- /rules: Pure logic
- Reference @docs/APPLICATION_BLUEPRINT.md

# NO DUPLICATE BUSINESS LOGIC
Follow @.agent/rules/business-logic-sync.md:
- Share logic between FE/BE
- Define logic once (preference: `frontend/src/shared/utils/`)

# USER EXPERIENCE RULE
Follow @.agent/rules/ux-rules.md:
- NEVER display technical IDs (UUIDs, CUIDs) in UI.
- Use human-readable names.

# BACKWARD COMPATIBILITY RULE (CRITICAL)
Follow @.agent/rules/compatibility-rules.md:
- NEVER break existing data.
- All schema changes MUST be backward compatible.
- Test on dapstage (PROD DATA) before prod.

See: @docs/development/BACKWARD_COMPATIBILITY.md and @docs/DEPLOYMENT_WORKFLOW.md for complete guidelines
# üõ°Ô∏è SRW GATEKEEPER (AUTOMATED)
Before every file save or "Apply" action in Composer:
1. **Lint**: Run `bash scripts/srw-audit.sh --staged` to verify SRW compliance.
2. **Architecture Check**: Verify the file path matches @.agent/rules/architecture.md.
   - Files in `/skills` MUST be stateless.
   - Files in `/rules` MUST NOT have imports from `backend/services`.
3. **Hierarchy Check**: If `env == dev`, verify no `git push` or `prod` credentials are being leaked per @.agent/rules/deployment-hierarchy.md.

# üö® FAILURE PROTOCOL
If `scripts/srw-audit.sh` fails:
- DO NOT save the file.
- Output the specific SRW violation.
- Propose a refactor that moves the violating logic to the correct SRW layer.
